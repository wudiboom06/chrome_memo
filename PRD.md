## 1. 概述
本项目目标是在 Chrome 扩展（Manifest V3）的弹窗中创建、查看、行内编辑与删除备忘录，并以 chrome.storage.local 实现本地持久化，确保重启浏览器后依然可见。本阶段明确不包含提醒时间、重复规则、系统通知、搜索与筛选、快捷键、右键菜单、云端同步、后台 service worker 以及任何网络请求。

### 1.1 目标
实现“随点随记”的最小可用功能：新增、行内编辑、删除、持久化与按更新时间倒序展示。

### 1.2 非目标
不做通知与重复；不做高级检索与筛选；不引入打包器或框架；不增加除 storage 外的任何权限。

## 2. 用户故事
当用户点击扩展图标时，可以在弹窗中输入文本并保存，随即看到新建的备忘录显示在顶部。用户可以在列表中直接切换到行内编辑模式修改内容并保存或取消。用户可以在列表中删除任意一条备忘录，删除前会看到二次确认提示。用户重启浏览器后再次打开扩展，仍能看到之前保存的内容。

## 3. 功能需求
新增功能要求弹窗顶部提供多行输入与保存按钮，空内容禁止保存并提示不可为空。列表展示以 updatedAt 字段倒序显示，最近变更项位于顶部。行内编辑模式需要支持保存与取消，保存后更新 updatedAt 并刷新排序，取消则维持原内容与排序。删除操作在用户确认后执行，并从本地存储中永久移除对应记录；取消删除则保持不变。无数据时显示空态提示，读写异常时显示简短错误信息。

## 4. 技术方案
Manifest 版本使用 3。界面仅使用 action 的 popup 页面，采用原生 HTML、CSS 与 JavaScript，不引入打包器或前端框架。权限仅声明 storage，用于本地数据持久化。存储位置使用 chrome.storage.local 而非 window.localStorage，以便统一权限与未来可扩展性。本阶段不编写 background 与 service worker 文件，以降低复杂度与心智负担。

## 5. 目录结构（目标产物）
以下目录结构在落盘后可直接通过“加载已解压的扩展程序”载入。
chrome-memo/
manifest.json
popup/
index.html
popup.css
popup.js
lib/
storage.js
id.js
assets/
icons/
icon16.png
icon32.png
icon48.png
icon128.png
README.md
instructions.md

## 6. 数据模型
数据实体 Note 包含四个字段，分别是 id（字符串）、content（字符串）、createdAt（UTC 毫秒时间戳）与 updatedAt（UTC 毫秒时间戳）。新增时写入 createdAt 与 updatedAt，编辑保存时仅更新 updatedAt。列表排序统一以 updatedAt 倒序口径执行。

## 7. 交互说明
弹窗顶部为输入区与保存按钮；保存成功后清空输入区，并将新增条目置顶显示。列表项默认展示文本与操作按钮；点击编辑后进入行内编辑状态，保存或取消后回到展示状态。删除操作在弹出二次确认后执行，确认删除才会移除数据。弹窗建议宽度为三百六十至四百二十像素，列表区域支持纵向滚动。

## 8. 验收标准
新增后应立即展示，并在刷新或重启浏览器后仍存在且内容一致。行内编辑保存后应更新 updatedAt 并使条目移动到顶部。删除应从视图与存储中同时移除且无残留。控制台不应出现错误信息，权限最小化仅 storage。

## 9. 版本管理与协作
本项目采用 Git 进行版本管理并托管至 GitHub。主分支命名为 main，功能开发通过特性分支进行并在 GitHub 发起 Pull Request 合并回 main。提交信息建议遵循 Conventional Commits 约定，并在稳定节点打上语义化标签，例如 v0.1.0 作为 MVP 首版。完整命令请参见 README 第 6 节的“Git 与 GitHub 常用命令”。

## 10. 安全与 Project Rules
建议在 .cursor/rules 目录中放置安全与权限白名单规则文件并设置 alwaysApply，以保证仅能修改当前项目内文件、禁止系统级危险操作，并将 manifest 权限白名单限定为 storage。

## 11. 既定决策口径
列表排序采用 updatedAt 倒序；编辑方式采用行内编辑；删除操作采用二次确认。